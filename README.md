# 顔検出と個人識別システム

このシステムでは、OpenCVを使って顔検出を行い、個人識別を実施します。以下の手順に従って環境構築から実装までを行います。

## 環境構築

まず、必要なライブラリをインストールします。以下のコマンドを実行してください。

```shell
pip install opencv pillow scikit-learn numpy matplotlib
```

## 学習モデルの作成
### 1. 画像データの収集
個人識別したい人物の写真を約200枚程度収集します。それぞれの写真には、その人物の名前をラベルとして付けます。

### 2. 顔部分の切り出し
収集した画像から顔部分を抽出するために、以下のスクリプト```face-gain.py```を実行します。このスクリプトにより、顔部分だけを切り出した画像が得られます。

### 3. データの整形
顔部分のみを切り出した画像から、顔以外の部分が検出されている画像を削除します。この処理後の画像データを学習データとして使用します。

### 4. 学習モデルの作成
scikit-learnを使用して、SVM（サポートベクターマシン）による学習モデルを作成します。以下のスクリプト```recognition_sav.py```を実行して、顔認識用の学習モデルを作成します。

```shell
python recognition_sav.py
```
この処理により、個人識別のためのモデル```face_model.sav```が作成されます。

## リアルタイム顔検出と個人識別
### 1. 学習モデルのロード
作成した学習モデル```face_model.sav```を使って、カメラを通じてリアルタイムで顔検出を行います。

### 2. 顔認識実行
以下のスクリプト```face-recognition.py```を実行すると、内蔵カメラが起動し、顔検出と同時に学習した人物の名前が赤い枠線で表示されます。

```shell
python face-recognition.py
```
### 参考文献
https://qiita.com/daiarg/items/3ea91b08f0d1cb5bfc61#2-%E5%AD%A6%E7%BF%92%E3%83%A2%E3%83%87%E3%83%AB%E3%81%AE%E4%BD%9C%E6%88%90

